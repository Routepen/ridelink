<div class="modal fade" id="facebookModal" tabindex="-1" role="dialog" aria-labelledby="facebookModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Copy and paste to facebook</h4>
      </div>
      <div class="modal-body">
        <% days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"] %>
        <div>
          <div>Driving to <%= routeData.destination %> on <%= days[routeData.date.getDay()] + " " + (routeData.date.getMonth() + 1) + "/" + routeData.date.getDate() %> around <%= routeData.time %>. <%= routeData.seats %> spots available, $<%= routeData.inconvenience %> per seat.</div>
          <br>
          <div>To all interested riders, enter your drop-off location in the link below. PM me if you have any questions!</div>
        </div>
        <a id="selfLink"></a>
      </div>
      <div class="modal-footer">
        <input type="submit" class="btn btn-primary" data-dismiss="modal" value="Done">
      </div>
    </div>
  </div>
</div>

<!--Rider view, use ejs to check if their facebook credentials is the original Facebook user or not-->
<div class="col-md-4" >
    <div >
        <h2>
            <%= routeData.driver.facebook.name.split(' ')[0] %>'s Route
        </h2>
        <form class="row" action="rider"></form>
        <% if (user) { %>
          <% if (isDriver) { %>
            <div class="panel panel-default" >
              <div class="panel-heading" id="link-panel">
                  <div class="col-md-6">
                      <a class="btn btn-md" onclick="toggleShareableLink()" href="javascript:void(0);">
                        Get link  <span class="glyphicon glyphicon-paperclip" > </span>
                      </a>
                  </div>
                  <div class="col-md-6" id="copy-link" align="right">
                      <a class="btn btn-md" onclick="showFBModal()" href="javascript:void(0);"> Show Post </a>
                  </div>
              </div>
              <div id="shareableLink" class="panel-body getlink-container" style="display:none">
                  <input onClick="select()"  class=" form-control" readonly="readonly" value="http://localhost:5000/route?id=<%= routeData.shortId || routeData._id %>"> </input>
              </div>
            </div>
          <% } else { %>
            <% var location = ""; %>
            <% if (user && routeData.dropOffs) { %>
             <% location = routeData.dropOffs[user._id] %>
            <% } %>
            <div id="dropOffTextEditable" style="display:none">
              <form action="javascript:return false">
                <span> <i class="material-icons">place</i> </span> <input id="pac-input" style="width:60%;" name="address" class="controls" type="text" placeholder="Enter dropoff address..." value="<%=location %>" autofocus>
                <input type="hidden" name="routeId" value="<%= routeId %>">
                <button type="button" class="btn btn-primary btn-sm editable-submit" onclick="javascript:riderLocationChanged()">
                  <i class="glyphicon glyphicon-ok"></i>
                </button>
                <button type="button" class="btn btn-default btn-sm editable-cancel" onclick="javascript:editableDone(false, 'dropOff')">
                  <i class="glyphicon glyphicon-remove"></i>
                </button>
                <br><br>
              </form>
            </div>
            <div id="dropOffText" style="display:none">
              <% if (confirmedRider) { %>
                <text>You've got a ride with <%= routeData.driver.facebook.name.split(' ')[0] %> to</text>
              <% } else { %>
                <text>You've requested a ride with <%= routeData.driver.facebook.name.split(' ')[0] %> to</text>
              <% } %>

              <span class="<%= confirmedRider ? "" : 'editableInput' %>"><%= location %></span>
            </div>
            <% if (confirmedRider && !routeData.riderStatus[user._id].paid) { %>
              <button type="button" class="btn btn-primary">Pay initial deposit</button>
            <% } %>
          <% } %>
        <% } else {  %>
          <a href="/auth/facebook?redirect=<%= encodeURIComponent('/route?id=' + (routeData.shortId || routeData._id)) %>")>Login to Facebook to request a ride</a>
        <% } %>
        <hr>

        <div class="form-inline editableform">
          <div id="originTextEditable" style="display:none">
            <i class="material-icons" style="font-size:18px">my_location</i>
            <input id="editOriginInput" type="text" class="form-control input-sm" style="width:60%" value="<%= routeData.origin %>" onkeydown="if (event.keyCode == 13) { editableDone(true, 'origin'); }">
            <button type="button" class="btn btn-primary btn-sm editable-submit" onclick="javascript:editableDone(true, 'origin')">
              <i class="glyphicon glyphicon-ok"></i>
            </button>
            <button type="button" class="btn btn-default btn-sm editable-cancel" onclick="javascript:editableDone(false, 'origin')">
              <i class="glyphicon glyphicon-remove"></i>
            </button>
          </div>
          <div id="originText" style="font-size:18px">
            <i class="material-icons" style="font-size:18px">my_location</i>
            <span class="<%= isDriver ?'editableInput' : '' %>"><%= routeData.origin %></span>
          </div>
        </div>

        <i class="material-icons" style="font-size:18px">arrow_downward</i><br>

        <div class="form-inline editableform">
          <div id="destinationTextEditable" style="display:none">
            <i class="material-icons" style="font-size:18px">my_location</i>
            <input id="editDestinationInput" type="text" class="form-control input-sm" style="width:60%" value="<%= routeData.destination %>"  onkeydown="if (event.keyCode == 13) { editableDone(true, 'destination'); }">
            <button type="button" class="btn btn-primary btn-sm editable-submit" onclick="javascript:editableDone(true, 'destination')">
              <i class="glyphicon glyphicon-ok"></i>
            </button>
            <button type="button" class="btn btn-default btn-sm editable-cancel" onclick="javascript:editableDone(false, 'destination')">
              <i class="glyphicon glyphicon-remove"></i>
            </button>
          </div>
          <div id="destinationText" style="font-size:18px">
            <i class="material-icons" style="font-size:18px">place</i>
            <span class="<%= isDriver ?'editableInput' : '' %>"><%= routeData.destination %></span>
          </div>
        </div>

        <br>


        <div class="form-inline editableform">
          <div id="seatsTextEditable" style="display:none">
            <i class="material-icons" style="font-size:18px">event_seat</i>
            <span style="">Total riders you can take:</span>
            <input id="editSeatsInput" type="text" class="form-control input-sm" value="<%= routeData.seats %>"  onkeydown="if (event.keyCode == 13) { editableDone(true, 'seats'); }">
            <button type="button" class="btn btn-primary btn-sm editable-submit" onclick="javascript:editableDone(true, 'seats')">
              <i class="glyphicon glyphicon-ok"></i>
            </button>
            <button type="button" class="btn btn-default btn-sm editable-cancel" onclick="javascript:editableDone(false, 'seats')">
              <i class="glyphicon glyphicon-remove"></i>
            </button>
          </div>

          <div id="seatsText" style="">
            <i class="material-icons" style="font-size:18px">event_seat</i>
            <text style="font-size:18px">Seats left: </text>
            <span style="font-size:18px" class="<%= isDriver ?'editableInput' : '' %>">
              <%= routeData.seats - routeData.confirmedRiders.length %>
            </span>
          </div>
        </div>


        <div class="form-inline editableform">
          <div id="dateTextEditable" style="display:none">
            <i class="material-icons" style="font-size:18px">event</i>
            <input id="editDateInput" type="text" class="form-control input-sm" value="<%= (routeData.date.getMonth() + 1) + '/' + routeData.date.getDate() + '/' +  routeData.date.getFullYear() %>"  onkeydown="if (event.keyCode == 13) { editableDone(true, 'date'); }">
            <button type="button" class="btn btn-primary btn-sm editable-submit" onclick="javascript:editableDone(true, 'date')">
              <i class="glyphicon glyphicon-ok"></i>
            </button>
            <button type="button" class="btn btn-default btn-sm editable-cancel" onclick="javascript:editableDone(false, 'date')">
              <i class="glyphicon glyphicon-remove"></i>
            </button>
          </div>

          <div id="dateText" style="">
            <i class="material-icons" style="font-size:18px">event</i>
            <span style="font-size:18px" class="<%= isDriver ?'editableInput' : '' %>">
              <%= (routeData.date.getMonth() + 1) + '/' + routeData.date.getDate() + '/' +  routeData.date.getFullYear() %>
            </span>
          </div>
        </div>

        <div class="form-inline editableform">
          <div id="timeTextEditable" style="display:none">
            <i class="material-icons" style="font-size:18px">event</i>
            <input id="editTimeInput" type="text" class="form-control input-sm" value="<%= routeData.time %>"  onkeydown="if (event.keyCode == 13) { editableDone(true, 'time'); }">
            <button type="button" class="btn btn-primary btn-sm editable-submit" onclick="javascript:editableDone(true, 'time')">
              <i class="glyphicon glyphicon-ok"></i>
            </button>
            <button type="button" class="btn btn-default btn-sm editable-cancel" onclick="javascript:editableDone(false, 'time')">
              <i class="glyphicon glyphicon-remove"></i>
            </button>
          </div>

          <div id="timeText" style="">
            <i class="material-icons" style="font-size:18px">access_time</i>
            <span style="font-size:18px" class="<%= isDriver ?'editableInput' : '' %>">
              <%= routeData.time %>
            </span>
          </div>
        </div>

        <div id="infoText" style="font-size:18px; padding-left: 20px; font-weight: bold"></div>

        <br><br>
        <div id="tableDiv" class="container-fluid row">
            <table class="table table-striped table-hover">
                <thead>
                <tr>
                    <th>#</th>
                    <th> Rider </th>
                    <th> Inconvenience cost </th>
                    <th> Confirmed </th>
                </tr>
                </thead>
                <tbody id="riderTable"></tbody>
            </table>
        </div>
    </div>
</div>
